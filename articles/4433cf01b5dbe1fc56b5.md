---
title: "GAS & TypeScript ã®ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚’æº–å‚™ã™ã‚‹"
emoji: "ğŸ˜½"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [gas]
published: true
---
# ã¯ã˜ã‚ã«
ä»Šå›ã®è¨˜äº‹ã§ä½œæˆã—ãŸå†…å®¹ã¯ã“ã¡ã‚‰ã‹ã‚‰ã‚¯ãƒ­ãƒ¼ãƒ³ã§ãã¾ã™ã€‚
é©å®œè¨­å®šå¤‰æ›´ã—ã¦åˆ©ç”¨ã—ã¦ãã ã•ã„ã€‚
https://github.com/iwatos/gas-template

ã¾ãŸã€GASãƒ‡ãƒ—ãƒ­ã‚¤/å…¬é–‹ã®è©³ã—ã„å†…å®¹ã¯æœ¬è¨˜äº‹ã§ã¯èª¬æ˜ã¯ã—ã¦ã¾ã›ã‚“ã€‚

# GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æº–å‚™
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå: `gas-project-directory`
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå: `gas-project`
ã¨ã—ã¦èª¬æ˜ã‚’é€²ã‚ã¾ã™ã€‚é©å®œè‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ã¦å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚

ã¾ãšGASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™
```shell
mkdir gas-project-directory
cd gas-project-directory
```

ä»¥ä¸‹ã®package.jsonã‚’ãƒ•ã‚©ãƒ«ãƒ€ç›´ä¸‹ã«ä½œæˆå¾Œã€yarnã‹npmã§installã‚’å®Ÿè¡Œã—ã¾ã™
GASã®ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ç”¨ã„ã‚‹`clasp`ã®ã»ã‹ã€`typescript` `eslint` `prettier`ã‚’å°å…¥ã—ã¦ã¾ã™ã€‚

```json:gas-project-directory/package.json
{
  "name": "<ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå>",
  "version": "1.0.0",
  "description": "Template of Google App Script ",
  "author": "<>",
  "license": "MIT",
  "scripts": {
    "lint": "prettier './src/**/*.{js,ts}' && eslint './src/**/*.{js,ts}'",
    "lintfix": "prettier --write './src/**/*.{js,ts}' && eslint --fix './src/**/*.{js,ts}'"
  },
  "dependencies": {
    "@google/clasp": "^2.3.0",
    "@types/google-apps-script": "^1.0.21"
  },
  "devDependencies": {
    "eslint": "^7.18.0",
    "prettier": "^2.2.1",
    "@typescript-eslint/eslint-plugin": "^4.14.0",
    "@typescript-eslint/parser": "^4.14.0",
    "eslint-config-prettier": "^7.2.0",
    "typescript": "^4.1.3"
  }
}
```
```sh
yarn install # ã¾ãŸã¯ `npm install`
```

GASã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§é–‹ç™ºã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«`clasp`ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™ã€‚
claspã‚’åˆ©ç”¨ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æ–°è¦ä½œæˆã—ã¾ã™

ã¾ãšã¯ä¸‹è¨˜ã‚³ãƒãƒ³ãƒ‰Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æºã‚’ãŠã“ãªã„ã¾ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶èªè¨¼ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
```sh
clasp login 
```

æ¬¡ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã‚’ãŠã“ãªã„ã¾ã™ã€‚
```sh
clasp create gas-project
# standalone, api, sheet, doc ãªã©åˆæœŸè¨­å®šã‚’èã‹ã‚Œã‚‹ã®ã§é¸ã¶
# ã©ã‚Œã‚’é¸ã‚“ã§ã‚‚ä»¥é™ã®ä½œæ¥­ã«å•é¡Œã¯ãªã„ã¯ãš 
```
å®Ÿè¡Œå¾Œã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã«ã€€`.clasp.json` `appscript.json` ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

ä»¥é™ã¯TypeScriptã®æº–å‚™ã«ãªã‚Šã¾ã™ã€‚
JSã§ã‚‚æ§‹ã‚ãªã„æ–¹ã¯ã€ã“ã®ã¾ã¾ä¸‹è¨˜ã®claspã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§GASé–‹ç™ºãŒè¡Œãˆã¾ã™ã€‚

# clasp ã‚³ãƒãƒ³ãƒ‰ç´¹ä»‹
ã‚ˆãä½¿ã†ã‚‚ã®
- `clasp open` ãƒ–ãƒ©ã‚¦ã‚¶ã§GASã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ã
- `clasp pull`ã‚¯ãƒ©ã‚¦ãƒ‰ã§ä¿å­˜ã•ã‚Œã¦ã„ã‚‹å†…å®¹ã‚’å–å¾—ã™ã‚‹
- `clasp push` ãƒ­ãƒ¼ã‚«ãƒ«ã®å†…å®¹ã‚’ã‚¯ãƒ©ã‚¦ãƒ‰ã«åæ˜ ã•ã›ã‚‹
- `clasp deploy` GASã‚’å…¬é–‹ã™ã‚‹
- `clasp login` Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚°ã‚¤ãƒ³
- `clasp logout` Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚°ã‚¢ã‚¦ãƒˆ

ãã®ä»–ã®ã‚³ãƒãƒ³ãƒ‰ãŒæ°—ã«ãªã‚‹æ–¹ã¯ã“ã¡ã‚‰ã‚’ã”å‚ç…§ãã ã•ã„ãƒ»
https://github.com/google/clasp/blob/a556599e78bdc3f168e3bb5cdc2ff0a55909f6f5/README.md

# TypeScriptå°å…¥
ã¾ãšã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã«`src`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¦ãã®é…ä¸‹ã«ç§»å‹•ã—ã¦ãã ã•ã„ã€‚
ãã®å¾Œ`.eslintrc.json` `.prettierrc.json` `tsconfig.json` ã‚’ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã«ä½œæˆã—ã¾ã™ã€‚

```json:.eslintrc.json
{
  "root": true,
  "parser": "@typescript-eslint/parser",
  "plugins": [
    "@typescript-eslint"
  ],
  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "prettier",
    "prettier/@typescript-eslint"
  ]
}
```
```json:.prettierrc.json
{
  "trailingComma": "es5",
  "tabWidth": 4,
  "semi": false,
  "singleQuote": true
}
```
```json:tsconfig.json
{
    "inlude": [
        "src/**/*"
    ],
    "compilerOptions": {
        "target": "ES2015",
        "module": "commonjs",
        "allowJs": false,
        "outDir": "./dist",
        "strict": true,   /* Enable all strict type-checking options. */
        "skipLibCheck": true
    }
}
```

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚
```sh
yarn run prettier './src/**/*.{js,ts}'
yarn run eslint './src/**/*.{js,ts}'
```

ä»¥ä¸Šã§TSå°å…¥ã‚‚ã“ã‚Œã§å®Œäº†ã§ã™ã€‚
`claspã€€push`ã¯ã‚¯ãƒ©ã‚¦ãƒ‰ã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã¨åŒæ™‚ã« TS â‡¨ JS å¤‰æ›ã‚‚è¡Œã„ã¾ã™ã€‚